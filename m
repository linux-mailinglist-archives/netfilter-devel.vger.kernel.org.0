Return-Path: <netfilter-devel-owner@vger.kernel.org>
X-Original-To: lists+netfilter-devel@lfdr.de
Delivered-To: lists+netfilter-devel@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.lfdr.de (Postfix) with ESMTP id D6E16E2DE4
	for <lists+netfilter-devel@lfdr.de>; Thu, 24 Oct 2019 11:51:03 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1726636AbfJXJvC (ORCPT <rfc822;lists+netfilter-devel@lfdr.de>);
        Thu, 24 Oct 2019 05:51:02 -0400
Received: from orbyte.nwl.cc ([151.80.46.58]:58220 "EHLO orbyte.nwl.cc"
        rhost-flags-OK-OK-OK-OK) by vger.kernel.org with ESMTP
        id S1725775AbfJXJvC (ORCPT <rfc822;netfilter-devel@vger.kernel.org>);
        Thu, 24 Oct 2019 05:51:02 -0400
Received: from n0-1 by orbyte.nwl.cc with local (Exim 4.91)
        (envelope-from <n0-1@orbyte.nwl.cc>)
        id 1iNZll-0000qZ-5W; Thu, 24 Oct 2019 11:51:01 +0200
Date:   Thu, 24 Oct 2019 11:51:01 +0200
From:   Phil Sutter <phil@nwl.cc>
To:     Pablo Neira Ayuso <pablo@netfilter.org>
Cc:     netfilter-devel@vger.kernel.org
Subject: Re: [iptables PATCH] nft: Use ARRAY_SIZE() macro in nft_strerror()
Message-ID: <20191024095101.GQ26123@orbyte.nwl.cc>
Mail-Followup-To: Phil Sutter <phil@nwl.cc>,
        Pablo Neira Ayuso <pablo@netfilter.org>,
        netfilter-devel@vger.kernel.org
References: <20191018155114.7423-1-phil@nwl.cc>
 <20191023112024.gd4dqe6qqv46hufe@salvia>
 <20191023112311.qrglbzhqad4vfqvo@salvia>
 <20191023121627.GM26123@orbyte.nwl.cc>
 <20191023204149.vushra6ipmjqqd7c@salvia>
 <20191024084503.GF17858@orbyte.nwl.cc>
 <20191024092903.sqvoxwwuflk2h4cn@salvia>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <20191024092903.sqvoxwwuflk2h4cn@salvia>
User-Agent: Mutt/1.10.1 (2018-07-13)
Sender: netfilter-devel-owner@vger.kernel.org
Precedence: bulk
List-ID: <netfilter-devel.vger.kernel.org>
X-Mailing-List: netfilter-devel@vger.kernel.org

Hey,

On Thu, Oct 24, 2019 at 11:29:03AM +0200, Pablo Neira Ayuso wrote:
[...]
> If gcc is already checking for this. Warning should be fine.
> 
> Regarding -Werror, we would at least need to keep the autogenerated C
> code by bison away from it.

In nftables there is libparser_la_CFLAGS which holds quite some
exclusions already and could be used to pass -Wno-error as well. (Maybe
a good idea to add this regardless of whether we set -Werror by default
or not.)

> IIRC I enabled this in conntrack-tools long time ago, and I started
> getting reports on it breaking compilation with new gcc versions that
> were actually spewing new warnings. That was stopping users to install
> latest, probably -Werror is too agressive?

Yes, I wasn't completely serious. Breaking users' builds for things they
may not be in control of is not the best idea. We could instead add a
configure option to enable strict mode, but checking for warnings is
something I usually do so probably not that important after all.

Cheers, Phil
