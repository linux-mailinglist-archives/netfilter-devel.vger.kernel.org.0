Return-Path: <netfilter-devel+bounces-743-lists+netfilter-devel=lfdr.de@vger.kernel.org>
X-Original-To: lists+netfilter-devel@lfdr.de
Delivered-To: lists+netfilter-devel@lfdr.de
Received: from ny.mirrors.kernel.org (ny.mirrors.kernel.org [IPv6:2604:1380:45d1:ec00::1])
	by mail.lfdr.de (Postfix) with ESMTPS id D50AE83973C
	for <lists+netfilter-devel@lfdr.de>; Tue, 23 Jan 2024 19:07:10 +0100 (CET)
Received: from smtp.subspace.kernel.org (wormhole.subspace.kernel.org [52.25.139.140])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by ny.mirrors.kernel.org (Postfix) with ESMTPS id 069151C211E5
	for <lists+netfilter-devel@lfdr.de>; Tue, 23 Jan 2024 18:07:10 +0000 (UTC)
Received: from localhost.localdomain (localhost.localdomain [127.0.0.1])
	by smtp.subspace.kernel.org (Postfix) with ESMTP id E75AB8120F;
	Tue, 23 Jan 2024 18:07:04 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org;
	dkim=fail reason="signature verification failed" (1024-bit key) header.d=163.com header.i=@163.com header.b="FTbDNp5/"
X-Original-To: netfilter-devel@vger.kernel.org
Received: from m16.mail.163.com (m16.mail.163.com [220.197.31.5])
	by smtp.subspace.kernel.org (Postfix) with ESMTP id 3CA2F81215;
	Tue, 23 Jan 2024 18:06:59 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org; arc=none smtp.client-ip=220.197.31.5
ARC-Seal:i=1; a=rsa-sha256; d=subspace.kernel.org; s=arc-20240116;
	t=1706033224; cv=none; b=Cpv9ZZgK0EgtI9s8Jti7aom/MyIw6jCgEsDfeauhAc2kaKfPNQskQ4sc7KqjKDiDqjWtM2pI4wBW4JPdFhn6vyU8hksR9uMMpeqIuEbdiLX0hzvL9dncH+G8RKJusZqqRzmmAXssZt8MD7UbQ9M+KO+05PkTDwuqc2s8wkPVQjE=
ARC-Message-Signature:i=1; a=rsa-sha256; d=subspace.kernel.org;
	s=arc-20240116; t=1706033224; c=relaxed/simple;
	bh=6uSz7RaeDAQyHs33wgiP1mtY7cpFoGOwcrSQaNlR4es=;
	h=Date:From:To:Cc:Subject:In-Reply-To:References:Content-Type:
	 MIME-Version:Message-ID; b=B/SX9eEfRNYp749/TbUv4WIq3gLbFm8eAOVedOHD+AFNBDJWPawvRBcoalW1PQGkzdxUNpOd9WemgCTOxAJfodF68KacO0j8HxV5hC5b9fOmA754iEcrJG0yyO/Rklnr0q72TNqP6ZJPQmUYzuvZB2LDs8Tl1MfF/KZB0GLY8IU=
ARC-Authentication-Results:i=1; smtp.subspace.kernel.org; dmarc=pass (p=none dis=none) header.from=163.com; spf=pass smtp.mailfrom=163.com; dkim=fail (1024-bit key) header.d=163.com header.i=@163.com header.b=FTbDNp5/ reason="signature verification failed"; arc=none smtp.client-ip=220.197.31.5
Authentication-Results: smtp.subspace.kernel.org; dmarc=pass (p=none dis=none) header.from=163.com
Authentication-Results: smtp.subspace.kernel.org; spf=pass smtp.mailfrom=163.com
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=163.com;
	s=s110527; h=Date:From:Subject:Content-Type:MIME-Version:
	Message-ID; bh=nqqB/gHbuGn4+znnU+hSgCvPWwzKd1uxGuzG5TlAqDc=; b=F
	TbDNp5/6KGuD5//1pOSuwWGD8fa17AD3c3HfML1SrnwFclMpMhSUTxCc1Y5sQ7aI
	wFIMUEP0jgMnusiK4b8n8rvbCsNBLqi9FfExvmEUfAfRBYZHWbbDz5yMVVv2vaG6
	SzFPkg4An4VR+Ldf/DDsKstYl9TofsoahRcUgmQGoo=
Received: from 00107082$163.com ( [111.35.184.37] ) by
 ajax-webmail-wmsvr-40-109 (Coremail) ; Wed, 24 Jan 2024 01:20:16 +0800
 (CST)
Date: Wed, 24 Jan 2024 01:20:16 +0800 (CST)
From: "David Wang" <00107082@163.com>
To: "Jozsef Kadlecsik" <kadlec@blackhole.kfki.hu>
Cc: "Eric Dumazet" <edumazet@google.com>, 
	"Pablo Neira Ayuso" <pablo@netfilter.org>, 
	netfilter-devel@vger.kernel.org, 
	"David Miller" <davem@davemloft.net>, netdev@vger.kernel.org, 
	kuba@kernel.org, pabeni@redhat.com, 
	"Florian Westphal" <fw@strlen.de>, 
	"Ale Crismani" <ale.crismani@automattic.com>
Subject: Re: [PATCH net 14/14] netfilter: ipset: fix performance regression
 in swap operation
X-Priority: 3
X-Mailer: Coremail Webmail Server Version XT5.0.14 build 20230109(dcb5de15)
 Copyright (c) 2002-2024 www.mailtech.cn 163com
In-Reply-To: <1a506719-db2b-c2ce-aaa2-d0067b3d772e@blackhole.kfki.hu>
References: <20240117160030.140264-1-pablo@netfilter.org>
 <20240117160030.140264-15-pablo@netfilter.org>
 <CANn89iKtpVy1kSSuk_RSGN0R6L+roNJr81ED4+a2SZ2WKzGsng@mail.gmail.com>
 <afb39fa8-3b28-27eb-c8ac-22691a064495@netfilter.org>
 <1a506719-db2b-c2ce-aaa2-d0067b3d772e@blackhole.kfki.hu>
X-NTES-SC: AL_Qu2bBPyYv0wq4CabY+kXn0oTju85XMCzuv8j3YJeN500uyT0xCEveXtfM2rdzMSVKiOctBybWRhoy/xIT5NaYoUdIfV5yS7eXfRK7GimdV+i
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset=UTF-8
Precedence: bulk
X-Mailing-List: netfilter-devel@vger.kernel.org
List-Id: <netfilter-devel.vger.kernel.org>
List-Subscribe: <mailto:netfilter-devel+subscribe@vger.kernel.org>
List-Unsubscribe: <mailto:netfilter-devel+unsubscribe@vger.kernel.org>
MIME-Version: 1.0
Message-ID: <a72b816.ab94.18d37564300.Coremail.00107082@163.com>
X-Coremail-Locale: zh_CN
X-CM-TRANSID:_____wD3f_hR9a9lKih8AA--.50537W
X-CM-SenderInfo: qqqrilqqysqiywtou0bp/1tbiqA1uqmVOB5W4WQAIsx
X-Coremail-Antispam: 1U5529EdanIXcx71UUUUU7vcSsGvfC2KfnxnUU==

CgpBdCAyMDI0LTAxLTIzIDE3OjAzOjQyLCAiSm96c2VmIEthZGxlY3NpayIgPGthZGxlY0BibGFj
a2hvbGUua2ZraS5odT4gd3JvdGU6Cj5IaSwKPgo+T24gVGh1LCAxOCBKYW4gMjAyNCwgSm96c2Vm
IEthZGxlY3NpayB3cm90ZToKPgo+PiBPbiBUaHUsIDE4IEphbiAyMDI0LCBFcmljIER1bWF6ZXQg
d3JvdGU6Cj4+IAo+PiA+IE9uIFdlZCwgSmFuIDE3LCAyMDI0IGF0IDU6MDDigK9QTSBQYWJsbyBO
ZWlyYSBBeXVzbyA8cGFibG9AbmV0ZmlsdGVyLm9yZz4gd3JvdGU6Cj4+ID4gPgo+PiA+ID4gVGhl
IHBhdGNoICJuZXRmaWx0ZXI6IGlwc2V0OiBmaXggcmFjZSBjb25kaXRpb24gYmV0d2VlbiBzd2Fw
L2Rlc3Ryb3kKPj4gPiA+IGFuZCBrZXJuZWwgc2lkZSBhZGQvZGVsL3Rlc3QiLCBjb21taXQgMjg2
MjhmYTkgZml4ZXMgYSByYWNlIGNvbmRpdGlvbi4KPj4gPiA+IEJ1dCB0aGUgc3luY2hyb25pemVf
cmN1KCkgYWRkZWQgdG8gdGhlIHN3YXAgZnVuY3Rpb24gdW5uZWNlc3NhcmlseSBzbG93cwo+PiA+
ID4gaXQgZG93bjogaXQgY2FuIHNhZmVseSBiZSBtb3ZlZCB0byBkZXN0cm95IGFuZCB1c2UgY2Fs
bF9yY3UoKSBpbnN0ZWFkLgo+PiA+ID4gVGh1cyB3ZSBjYW4gZ2V0IGJhY2sgdGhlIHNhbWUgcGVy
Zm9ybWFuY2UgYW5kIHByZXZlbnRpbmcgdGhlIHJhY2UgY29uZGl0aW9uCj4+ID4gPiBhdCB0aGUg
c2FtZSB0aW1lLgo+Wy4uLl0KPj4gPiA+ICtzdGF0aWMgdm9pZAo+PiA+ID4gK2lwX3NldF9kZXN0
cm95X3NldF9yY3Uoc3RydWN0IHJjdV9oZWFkICpoZWFkKQo+PiA+ID4gK3sKPj4gPiA+ICsgICAg
ICAgc3RydWN0IGlwX3NldCAqc2V0ID0gY29udGFpbmVyX29mKGhlYWQsIHN0cnVjdCBpcF9zZXQs
IHJjdSk7Cj4+ID4gPiArCj4+ID4gPiArICAgICAgIGlwX3NldF9kZXN0cm95X3NldChzZXQpOwo+
PiA+IAo+PiA+IENhbGxpbmcgaXBfc2V0X2Rlc3Ryb3lfc2V0KCkgZnJvbSBCSCAocmN1IGNhbGxi
YWNrcykgaXMgbm90IHdvcmtpbmcuCj4+IAo+PiBZZWFoLCBpdCBjYWxscyBjYW5jZWxfZGVsYXll
ZF93b3JrX3N5bmMoKSB0byBoYW5kbGUgdGhlIGdhcmJhZ2UgY29sbGVjdG9yIAo+PiBhbmQgdGhh
dCBjYW4gd2FpdC4gVGhlIGNhbGwgY2FuIGJlIG1vdmVkIGludG8gdGhlIG1haW4gZGVzdHJveSBm
dW5jdGlvbiAKPj4gYW5kIGxldCB0aGUgcmN1IGNhbGxiYWNrIGRvIGp1c3QgdGhlIG1pbmltYWwg
am9iLCBob3dldmVyIGl0IG5lZWRzIGEgCj4+IHJlc3RydWN0dXJpbmcuIFNvIHBsZWFzZSBza2lw
IHRoaXMgcGF0Y2ggbm93Lgo+Cj5JIHJld29ya2VkIHRoZSBwYXRjaCB0byB3b3JrIHNhZmVseSB3
aXRoIHVzaW5nIGNhbGxfcmN1KCkgYW5kIHN0aWxsIAo+cHJldmVudGluZyB0aGUgcmFjZSBjb25k
aXRpb24uIEFjY29yZGluZyB0byBteSB0ZXN0cyB0aGUgcGF0Y2ggd29ya3MgYXMgCj5pbnRlbmRl
ZCwgYnV0IGl0J2QgYmUgZ29vZCB0byByZWNlaXZlIGZlZWRiYWNrIHRoYXQgaXQgaW5kZWVkIGZp
eGVzIHRoZSAKPmlzc3VlIHByb3Blcmx5LgoKSSBhcHBseSB0aGUgcGF0Y2ggb24gNi44LjAtcmMx
LCBzdHJlc3MgY3JlYXRlLWFkZC1zd2FwLWRlc3Ryb3kgc2VxdWVuY2UgZm9yIDEwMDAwMDAgcm91
bmRzLCBhbmQgbm8gcGVyZm9ybWFuY2UgcmVncmVzc2lvbiBvYnNlcnZlZC4KCiAgICAkIHRpbWUg
c3VkbyAuL2Eub3V0IAogICAgCiAgICByZWFsCTBtMTkuNzE3cwogICAgdXNlcgkwbTAuODQ5cwog
ICAgIHN5cwkwbTE3LjA2MHMKCkkgYWxzbyB0ZXN0IHdpdGggdHdvIHByb2Nlc3NlcyBjcmVhdGUt
YWRkLXN3YXAtZGVzdHJveSBkaXNqb2ludCBzZXQgb2YgaXBzZXQgcGFyYWxsZWxseSBvbiBhIDIt
Q29yZSBWTSwgIG5vIGFibm9ybWFsaXR5IG5vdGljZWQgb3RoZXIgdGhhbiBzb21lIHNsb3dlciwg
SSBndWVzcyB0aGlzIGlzIGV4cGVjdGVkLCByaWdodD8KCiAgICAkIHRpbWUgc3VkbyAuL2Eub3V0
IAoKICAgIHJlYWwJMG0yMy42MjVzCiAgICB1c2VyCTBtMC44MjdzCiAgICAgc3lzCTBtMjAuMjIy
cwoKICAgICQgdGltZSBzdWRvIC4vYTIub3V0IAogICAgCiAgICByZWFsCTBtMjMuODM4cwogICAg
dXNlcgkwbTAuODM1cwogICAgIHN5cwkwbTIwLjQwMXMKCgpObyBvYnZlcnNlIHNsYWIgbWVtb3J5
IGluY3JlbWVudCBjYW4gYmUgY29uZmlybWVkIGFmdGVyIHNldmVyYWwgcm91bmQgb2Ygc3RyZXNz
LgoKY2F0IC9wcm9jL21lbWluZm8gfCBncmVwIFNsYWI6IAozOTI0OCBrQiAgLSAgMzkzNjgga0Ig
IC0tIDM5MzQwIGtCIC0gMzkzODgga0IgLS0tLS0gMzkzMDgga0IgCgoKRllJCkRhdmlkCgo+Cj5G
cm9tIDIzZTg1ZjQ1M2RhNTczZGQ0MjY1ZTdkMWZmZmQyYWVhYjMzNjllMGQgTW9uIFNlcCAxNyAw
MDowMDowMCAyMDAxCj5Gcm9tOiBKb3pzZWYgS2FkbGVjc2lrIDxrYWRsZWNAbmV0ZmlsdGVyLm9y
Zz4KPkRhdGU6IFR1ZSwgMTYgSmFuIDIwMjQgMTc6MTA6NDUgKzAxMDAKPlN1YmplY3Q6IFtQQVRD
SCAxLzFdIG5ldGZpbHRlcjogaXBzZXQ6IGZpeCBwZXJmb3JtYW5jZSByZWdyZXNzaW9uIGluIHN3
YXAKPiBvcGVyYXRpb24KPgo+VGhlIHBhdGNoICJuZXRmaWx0ZXI6IGlwc2V0OiBmaXggcmFjZSBj
b25kaXRpb24gYmV0d2VlbiBzd2FwL2Rlc3Ryb3kKPmFuZCBrZXJuZWwgc2lkZSBhZGQvZGVsL3Rl
c3QiLCBjb21taXQgMjg2MjhmYTkgZml4ZXMgYSByYWNlIGNvbmRpdGlvbi4KPkJ1dCB0aGUgc3lu
Y2hyb25pemVfcmN1KCkgYWRkZWQgdG8gdGhlIHN3YXAgZnVuY3Rpb24gdW5uZWNlc3NhcmlseSBz
bG93cwo+aXQgZG93bjogaXQgY2FuIHNhZmVseSBiZSBtb3ZlZCB0byBkZXN0cm95IGFuZCB1c2Ug
Y2FsbF9yY3UoKSBpbnN0ZWFkLgo+Cj5FcmljIER1bWF6ZXQgcG9pbnRlZCBvdXQgdGhhdCBzaW1w
bHkgY2FsbGluZyB0aGUgZGVzdHJveSBmdW5jdGlvbnMgYXMKPnJjdSBjYWxsYmFjayBkb2VzIG5v
dCB3b3JrOiBzZXRzIHdpdGggdGltZW91dCB1c2UgZ2FyYmFnZSBjb2xsZWN0b3JzCj53aGljaCBu
ZWVkIGNhbmNlbGxpbmcgYXQgZGVzdHJveSB3aGljaCBjYW4gd2FpdC4gVGhlcmVmb3JlIHRoZSBk
ZXN0cm95Cj5mdW5jdGlvbnMgYXJlIHNwbGl0IGludG8gdHdvOiBjYW5jZWxsaW5nIGdhcmJhZ2Ug
Y29sbGVjdG9ycyBzYWZlbHkgYXQKPmV4ZWN1dGluZyB0aGUgY29tbWFuZCByZWNlaXZlZCBieSBu
ZXRsaW5rIGFuZCBtb3ZpbmcgdGhlIHJlbWFpbmluZwo+cGFydCBvbmx5IGludG8gdGhlIHJjdSBj
YWxsYmFjay4KPgo+TGluazogaHR0cHM6Ly9sb3JlLmtlcm5lbC5vcmcvbGttbC9DMDgyOUIxMC1F
QUE2LTQ4MDktODc0RS1FMUU5QzA1QThEODRAYXV0b21hdHRpYy5jb20vCj5GaXhlczogMjg2Mjhm
YTk1MmZlICgibmV0ZmlsdGVyOiBpcHNldDogZml4IHJhY2UgY29uZGl0aW9uIGJldHdlZW4gc3dh
cC9kZXN0cm95IGFuZCBrZXJuZWwgc2lkZSBhZGQvZGVsL3Rlc3QiKQo+UmVwb3J0ZWQtYnk6IEFs
ZSBDcmlzbWFuaSA8YWxlLmNyaXNtYW5pQGF1dG9tYXR0aWMuY29tPgo+UmVwb3J0ZWQtYnk6IERh
dmlkIFdhbmcgPDAwMTA3MDgyQDE2My5jb20KPlNpZ25lZC1vZmYtYnk6IEpvenNlZiBLYWRsZWNz
aWsgPGthZGxlY0BuZXRmaWx0ZXIub3JnPgo+LS0tCj4gaW5jbHVkZS9saW51eC9uZXRmaWx0ZXIv
aXBzZXQvaXBfc2V0LmggIHwgIDQgKysrCj4gbmV0L25ldGZpbHRlci9pcHNldC9pcF9zZXRfYml0
bWFwX2dlbi5oIHwgMTQgKysrKysrKystLQo+IG5ldC9uZXRmaWx0ZXIvaXBzZXQvaXBfc2V0X2Nv
cmUuYyAgICAgICB8IDM3ICsrKysrKysrKysrKysrKysrKystLS0tLS0KPiBuZXQvbmV0ZmlsdGVy
L2lwc2V0L2lwX3NldF9oYXNoX2dlbi5oICAgfCAxNSArKysrKysrKy0tCj4gbmV0L25ldGZpbHRl
ci9pcHNldC9pcF9zZXRfbGlzdF9zZXQuYyAgIHwgMTMgKysrKysrKy0tCj4gNSBmaWxlcyBjaGFu
Z2VkLCA2NSBpbnNlcnRpb25zKCspLCAxOCBkZWxldGlvbnMoLSkKPgo+ZGlmZiAtLWdpdCBhL2lu
Y2x1ZGUvbGludXgvbmV0ZmlsdGVyL2lwc2V0L2lwX3NldC5oIGIvaW5jbHVkZS9saW51eC9uZXRm
aWx0ZXIvaXBzZXQvaXBfc2V0LmgKPmluZGV4IGU4YzM1MGEzYWRlMS4uZTlmNGY4NDVkNzYwIDEw
MDY0NAo+LS0tIGEvaW5jbHVkZS9saW51eC9uZXRmaWx0ZXIvaXBzZXQvaXBfc2V0LmgKPisrKyBi
L2luY2x1ZGUvbGludXgvbmV0ZmlsdGVyL2lwc2V0L2lwX3NldC5oCj5AQCAtMTg2LDYgKzE4Niw4
IEBAIHN0cnVjdCBpcF9zZXRfdHlwZV92YXJpYW50IHsKPiAJLyogUmV0dXJuIHRydWUgaWYgImIi
IHNldCBpcyB0aGUgc2FtZSBhcyAiYSIKPiAJICogYWNjb3JkaW5nIHRvIHRoZSBjcmVhdGUgc2V0
IHBhcmFtZXRlcnMgKi8KPiAJYm9vbCAoKnNhbWVfc2V0KShjb25zdCBzdHJ1Y3QgaXBfc2V0ICph
LCBjb25zdCBzdHJ1Y3QgaXBfc2V0ICpiKTsKPisJLyogQ2FuY2VsIG9uZ29pbmcgZ2FyYmFnZSBj
b2xsZWN0b3JzIGJlZm9yZSBkZXN0cm95aW5nIHRoZSBzZXQqLwo+Kwl2b2lkICgqY2FuY2VsX2dj
KShzdHJ1Y3QgaXBfc2V0ICpzZXQpOwo+IAkvKiBSZWdpb24tbG9ja2luZyBpcyB1c2VkICovCj4g
CWJvb2wgcmVnaW9uX2xvY2s7Cj4gfTsKPkBAIC0yNDIsNiArMjQ0LDggQEAgZXh0ZXJuIHZvaWQg
aXBfc2V0X3R5cGVfdW5yZWdpc3RlcihzdHJ1Y3QgaXBfc2V0X3R5cGUgKnNldF90eXBlKTsKPiAK
PiAvKiBBIGdlbmVyaWMgSVAgc2V0ICovCj4gc3RydWN0IGlwX3NldCB7Cj4rCS8qIEZvciBjYWxs
X2NydSBpbiBkZXN0cm95ICovCj4rCXN0cnVjdCByY3VfaGVhZCByY3U7Cj4gCS8qIFRoZSBuYW1l
IG9mIHRoZSBzZXQgKi8KPiAJY2hhciBuYW1lW0lQU0VUX01BWE5BTUVMRU5dOwo+IAkvKiBMb2Nr
IHByb3RlY3RpbmcgdGhlIHNldCBkYXRhICovCj5kaWZmIC0tZ2l0IGEvbmV0L25ldGZpbHRlci9p
cHNldC9pcF9zZXRfYml0bWFwX2dlbi5oIGIvbmV0L25ldGZpbHRlci9pcHNldC9pcF9zZXRfYml0
bWFwX2dlbi5oCj5pbmRleCAyNmFiMGU5NjEyZDguLjk1MjMxMDRhOTBkYSAxMDA2NDQKPi0tLSBh
L25ldC9uZXRmaWx0ZXIvaXBzZXQvaXBfc2V0X2JpdG1hcF9nZW4uaAo+KysrIGIvbmV0L25ldGZp
bHRlci9pcHNldC9pcF9zZXRfYml0bWFwX2dlbi5oCj5AQCAtMjgsNiArMjgsNyBAQAo+ICNkZWZp
bmUgbXR5cGVfZGVsCQlJUFNFVF9UT0tFTihNVFlQRSwgX2RlbCkKPiAjZGVmaW5lIG10eXBlX2xp
c3QJCUlQU0VUX1RPS0VOKE1UWVBFLCBfbGlzdCkKPiAjZGVmaW5lIG10eXBlX2djCQlJUFNFVF9U
T0tFTihNVFlQRSwgX2djKQo+KyNkZWZpbmUgbXR5cGVfY2FuY2VsX2djCQlJUFNFVF9UT0tFTihN
VFlQRSwgX2NhbmNlbF9nYykKPiAjZGVmaW5lIG10eXBlCQkJTVRZUEUKPiAKPiAjZGVmaW5lIGdl
dF9leHQoc2V0LCBtYXAsIGlkKQkoKG1hcCktPmV4dGVuc2lvbnMgKyAoKHNldCktPmRzaXplICog
KGlkKSkpCj5AQCAtNTcsOSArNTgsNiBAQCBtdHlwZV9kZXN0cm95KHN0cnVjdCBpcF9zZXQgKnNl
dCkKPiB7Cj4gCXN0cnVjdCBtdHlwZSAqbWFwID0gc2V0LT5kYXRhOwo+IAo+LQlpZiAoU0VUX1dJ
VEhfVElNRU9VVChzZXQpKQo+LQkJZGVsX3RpbWVyX3N5bmMoJm1hcC0+Z2MpOwo+LQo+IAlpZiAo
c2V0LT5kc2l6ZSAmJiBzZXQtPmV4dGVuc2lvbnMgJiBJUFNFVF9FWFRfREVTVFJPWSkKPiAJCW10
eXBlX2V4dF9jbGVhbnVwKHNldCk7Cj4gCWlwX3NldF9mcmVlKG1hcC0+bWVtYmVycyk7Cj5AQCAt
Mjg4LDYgKzI4NiwxNSBAQCBtdHlwZV9nYyhzdHJ1Y3QgdGltZXJfbGlzdCAqdCkKPiAJYWRkX3Rp
bWVyKCZtYXAtPmdjKTsKPiB9Cj4gCj4rc3RhdGljIHZvaWQKPittdHlwZV9jYW5jZWxfZ2Moc3Ry
dWN0IGlwX3NldCAqc2V0KQo+K3sKPisJc3RydWN0IG10eXBlICptYXAgPSBzZXQtPmRhdGE7Cj4r
Cj4rCWlmIChTRVRfV0lUSF9USU1FT1VUKHNldCkpCj4rCQlkZWxfdGltZXJfc3luYygmbWFwLT5n
Yyk7Cj4rfQo+Kwo+IHN0YXRpYyBjb25zdCBzdHJ1Y3QgaXBfc2V0X3R5cGVfdmFyaWFudCBtdHlw
ZSA9IHsKPiAJLmthZHQJPSBtdHlwZV9rYWR0LAo+IAkudWFkdAk9IG10eXBlX3VhZHQsCj5AQCAt
MzAxLDYgKzMwOCw3IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgaXBfc2V0X3R5cGVfdmFyaWFudCBt
dHlwZSA9IHsKPiAJLmhlYWQJPSBtdHlwZV9oZWFkLAo+IAkubGlzdAk9IG10eXBlX2xpc3QsCj4g
CS5zYW1lX3NldCA9IG10eXBlX3NhbWVfc2V0LAo+KwkuY2FuY2VsX2djID0gbXR5cGVfY2FuY2Vs
X2djLAo+IH07Cj4gCj4gI2VuZGlmIC8qIF9fSVBfU0VUX0JJVE1BUF9JUF9HRU5fSCAqLwo+ZGlm
ZiAtLWdpdCBhL25ldC9uZXRmaWx0ZXIvaXBzZXQvaXBfc2V0X2NvcmUuYyBiL25ldC9uZXRmaWx0
ZXIvaXBzZXQvaXBfc2V0X2NvcmUuYwo+aW5kZXggNGMxMzNlMDZiZTFkLi5iY2FhZDljMDA5ZmUg
MTAwNjQ0Cj4tLS0gYS9uZXQvbmV0ZmlsdGVyL2lwc2V0L2lwX3NldF9jb3JlLmMKPisrKyBiL25l
dC9uZXRmaWx0ZXIvaXBzZXQvaXBfc2V0X2NvcmUuYwo+QEAgLTExODIsNiArMTE4MiwxNCBAQCBp
cF9zZXRfZGVzdHJveV9zZXQoc3RydWN0IGlwX3NldCAqc2V0KQo+IAlrZnJlZShzZXQpOwo+IH0K
PiAKPitzdGF0aWMgdm9pZAo+K2lwX3NldF9kZXN0cm95X3NldF9yY3Uoc3RydWN0IHJjdV9oZWFk
ICpoZWFkKQo+K3sKPisJc3RydWN0IGlwX3NldCAqc2V0ID0gY29udGFpbmVyX29mKGhlYWQsIHN0
cnVjdCBpcF9zZXQsIHJjdSk7Cj4rCj4rCWlwX3NldF9kZXN0cm95X3NldChzZXQpOwo+K30KPisK
PiBzdGF0aWMgaW50IGlwX3NldF9kZXN0cm95KHN0cnVjdCBza19idWZmICpza2IsIGNvbnN0IHN0
cnVjdCBuZm5sX2luZm8gKmluZm8sCj4gCQkJICBjb25zdCBzdHJ1Y3QgbmxhdHRyICogY29uc3Qg
YXR0cltdKQo+IHsKPkBAIC0xMTkzLDggKzEyMDEsNiBAQCBzdGF0aWMgaW50IGlwX3NldF9kZXN0
cm95KHN0cnVjdCBza19idWZmICpza2IsIGNvbnN0IHN0cnVjdCBuZm5sX2luZm8gKmluZm8sCj4g
CWlmICh1bmxpa2VseShwcm90b2NvbF9taW5fZmFpbGVkKGF0dHIpKSkKPiAJCXJldHVybiAtSVBT
RVRfRVJSX1BST1RPQ09MOwo+IAo+LQkvKiBNdXN0IHdhaXQgZm9yIGZsdXNoIHRvIGJlIHJlYWxs
eSBmaW5pc2hlZCBpbiBsaXN0OnNldCAqLwo+LQlyY3VfYmFycmllcigpOwo+IAo+IAkvKiBDb21t
YW5kcyBhcmUgc2VyaWFsaXplZCBhbmQgcmVmZXJlbmNlcyBhcmUKPiAJICogcHJvdGVjdGVkIGJ5
IHRoZSBpcF9zZXRfcmVmX2xvY2suCj5AQCAtMTIwNiw4ICsxMjEyLDEwIEBAIHN0YXRpYyBpbnQg
aXBfc2V0X2Rlc3Ryb3koc3RydWN0IHNrX2J1ZmYgKnNrYiwgY29uc3Qgc3RydWN0IG5mbmxfaW5m
byAqaW5mbywKPiAJICogY291bnRlciwgc28gaWYgaXQncyBhbHJlYWR5IHplcm8sIHdlIGNhbiBw
cm9jZWVkCj4gCSAqIHdpdGhvdXQgaG9sZGluZyB0aGUgbG9jay4KPiAJICovCj4tCXJlYWRfbG9j
a19iaCgmaXBfc2V0X3JlZl9sb2NrKTsKPiAJaWYgKCFhdHRyW0lQU0VUX0FUVFJfU0VUTkFNRV0p
IHsKPisJCS8qIE11c3Qgd2FpdCBmb3IgZmx1c2ggdG8gYmUgcmVhbGx5IGZpbmlzaGVkIGluIGxp
c3Q6c2V0ICovCj4rCQlyY3VfYmFycmllcigpOwo+KwkJcmVhZF9sb2NrX2JoKCZpcF9zZXRfcmVm
X2xvY2spOwo+IAkJZm9yIChpID0gMDsgaSA8IGluc3QtPmlwX3NldF9tYXg7IGkrKykgewo+IAkJ
CXMgPSBpcF9zZXQoaW5zdCwgaSk7Cj4gCQkJaWYgKHMgJiYgKHMtPnJlZiB8fCBzLT5yZWZfbmV0
bGluaykpIHsKPkBAIC0xMjIxLDYgKzEyMjksOCBAQCBzdGF0aWMgaW50IGlwX3NldF9kZXN0cm95
KHN0cnVjdCBza19idWZmICpza2IsIGNvbnN0IHN0cnVjdCBuZm5sX2luZm8gKmluZm8sCj4gCQkJ
cyA9IGlwX3NldChpbnN0LCBpKTsKPiAJCQlpZiAocykgewo+IAkJCQlpcF9zZXQoaW5zdCwgaSkg
PSBOVUxMOwo+KwkJCQkvKiBNdXN0IGNhbmNlbCBnYXJiYWdlIGNvbGxlY3RvcnMgKi8KPisJCQkJ
cy0+dmFyaWFudC0+Y2FuY2VsX2djKHMpOwo+IAkJCQlpcF9zZXRfZGVzdHJveV9zZXQocyk7Cj4g
CQkJfQo+IAkJfQo+QEAgLTEyMjgsNiArMTIzOCw5IEBAIHN0YXRpYyBpbnQgaXBfc2V0X2Rlc3Ry
b3koc3RydWN0IHNrX2J1ZmYgKnNrYiwgY29uc3Qgc3RydWN0IG5mbmxfaW5mbyAqaW5mbywKPiAJ
CWluc3QtPmlzX2Rlc3Ryb3llZCA9IGZhbHNlOwo+IAl9IGVsc2Ugewo+IAkJdTMyIGZsYWdzID0g
ZmxhZ19leGlzdChpbmZvLT5ubGgpOwo+KwkJdTE2IGZlYXR1cmVzID0gMDsKPisKPisJCXJlYWRf
bG9ja19iaCgmaXBfc2V0X3JlZl9sb2NrKTsKPiAJCXMgPSBmaW5kX3NldF9hbmRfaWQoaW5zdCwg
bmxhX2RhdGEoYXR0cltJUFNFVF9BVFRSX1NFVE5BTUVdKSwKPiAJCQkJICAgICZpKTsKPiAJCWlm
ICghcykgewo+QEAgLTEyMzgsMTAgKzEyNTEsMTYgQEAgc3RhdGljIGludCBpcF9zZXRfZGVzdHJv
eShzdHJ1Y3Qgc2tfYnVmZiAqc2tiLCBjb25zdCBzdHJ1Y3QgbmZubF9pbmZvICppbmZvLAo+IAkJ
CXJldCA9IC1JUFNFVF9FUlJfQlVTWTsKPiAJCQlnb3RvIG91dDsKPiAJCX0KPisJCWZlYXR1cmVz
ID0gcy0+dHlwZS0+ZmVhdHVyZXM7Cj4gCQlpcF9zZXQoaW5zdCwgaSkgPSBOVUxMOwo+IAkJcmVh
ZF91bmxvY2tfYmgoJmlwX3NldF9yZWZfbG9jayk7Cj4tCj4tCQlpcF9zZXRfZGVzdHJveV9zZXQo
cyk7Cj4rCQlpZiAoZmVhdHVyZXMgJiBJUFNFVF9UWVBFX05BTUUpIHsKPisJCQkvKiBNdXN0IHdh
aXQgZm9yIGZsdXNoIHRvIGJlIHJlYWxseSBmaW5pc2hlZCAgKi8KPisJCQlyY3VfYmFycmllcigp
Owo+KwkJfQo+KwkJLyogTXVzdCBjYW5jZWwgZ2FyYmFnZSBjb2xsZWN0b3JzICovCj4rCQlzLT52
YXJpYW50LT5jYW5jZWxfZ2Mocyk7Cj4rCQljYWxsX3JjdSgmcy0+cmN1LCBpcF9zZXRfZGVzdHJv
eV9zZXRfcmN1KTsKPiAJfQo+IAlyZXR1cm4gMDsKPiBvdXQ6Cj5AQCAtMTM5NCw5ICsxNDEzLDYg
QEAgc3RhdGljIGludCBpcF9zZXRfc3dhcChzdHJ1Y3Qgc2tfYnVmZiAqc2tiLCBjb25zdCBzdHJ1
Y3QgbmZubF9pbmZvICppbmZvLAo+IAlpcF9zZXQoaW5zdCwgdG9faWQpID0gZnJvbTsKPiAJd3Jp
dGVfdW5sb2NrX2JoKCZpcF9zZXRfcmVmX2xvY2spOwo+IAo+LQkvKiBNYWtlIHN1cmUgYWxsIHJl
YWRlcnMgb2YgdGhlIG9sZCBzZXQgcG9pbnRlcnMgYXJlIGNvbXBsZXRlZC4gKi8KPi0Jc3luY2hy
b25pemVfcmN1KCk7Cj4tCj4gCXJldHVybiAwOwo+IH0KPiAKPkBAIC0yNDA5LDggKzI0MjUsMTEg
QEAgaXBfc2V0X2Zpbmkodm9pZCkKPiB7Cj4gCW5mX3VucmVnaXN0ZXJfc29ja29wdCgmc29fc2V0
KTsKPiAJbmZuZXRsaW5rX3N1YnN5c191bnJlZ2lzdGVyKCZpcF9zZXRfbmV0bGlua19zdWJzeXMp
Owo+LQo+IAl1bnJlZ2lzdGVyX3Blcm5ldF9zdWJzeXMoJmlwX3NldF9uZXRfb3BzKTsKPisKPisJ
LyogV2FpdCBmb3IgY2FsbF9yY3UoKSBpbiBkZXN0cm95ICovCj4rCXJjdV9iYXJyaWVyKCk7Cj4r
Cj4gCXByX2RlYnVnKCJ0aGVzZSBhcmUgdGhlIGZhbW91cyBsYXN0IHdvcmRzXG4iKTsKPiB9Cj4g
Cj5kaWZmIC0tZ2l0IGEvbmV0L25ldGZpbHRlci9pcHNldC9pcF9zZXRfaGFzaF9nZW4uaCBiL25l
dC9uZXRmaWx0ZXIvaXBzZXQvaXBfc2V0X2hhc2hfZ2VuLmgKPmluZGV4IDdjMjM5OTU0MTc3MS4u
YzYyOTk4YjQ2ZjAwIDEwMDY0NAo+LS0tIGEvbmV0L25ldGZpbHRlci9pcHNldC9pcF9zZXRfaGFz
aF9nZW4uaAo+KysrIGIvbmV0L25ldGZpbHRlci9pcHNldC9pcF9zZXRfaGFzaF9nZW4uaAo+QEAg
LTIyMSw2ICsyMjEsNyBAQCBzdGF0aWMgY29uc3QgdW5pb24gbmZfaW5ldF9hZGRyIHplcm9tYXNr
ID0ge307Cj4gI3VuZGVmIG10eXBlX2djX2RvCj4gI3VuZGVmIG10eXBlX2djCj4gI3VuZGVmIG10
eXBlX2djX2luaXQKPisjdW5kZWYgbXR5cGVfY2FuY2VsX2djCj4gI3VuZGVmIG10eXBlX3Zhcmlh
bnQKPiAjdW5kZWYgbXR5cGVfZGF0YV9tYXRjaAo+IAo+QEAgLTI2NSw2ICsyNjYsNyBAQCBzdGF0
aWMgY29uc3QgdW5pb24gbmZfaW5ldF9hZGRyIHplcm9tYXNrID0ge307Cj4gI2RlZmluZSBtdHlw
ZV9nY19kbwkJSVBTRVRfVE9LRU4oTVRZUEUsIF9nY19kbykKPiAjZGVmaW5lIG10eXBlX2djCQlJ
UFNFVF9UT0tFTihNVFlQRSwgX2djKQo+ICNkZWZpbmUgbXR5cGVfZ2NfaW5pdAkJSVBTRVRfVE9L
RU4oTVRZUEUsIF9nY19pbml0KQo+KyNkZWZpbmUgbXR5cGVfY2FuY2VsX2djCQlJUFNFVF9UT0tF
TihNVFlQRSwgX2NhbmNlbF9nYykKPiAjZGVmaW5lIG10eXBlX3ZhcmlhbnQJCUlQU0VUX1RPS0VO
KE1UWVBFLCBfdmFyaWFudCkKPiAjZGVmaW5lIG10eXBlX2RhdGFfbWF0Y2gJSVBTRVRfVE9LRU4o
TVRZUEUsIF9kYXRhX21hdGNoKQo+IAo+QEAgLTQ0OSw5ICs0NTEsNiBAQCBtdHlwZV9kZXN0cm95
KHN0cnVjdCBpcF9zZXQgKnNldCkKPiAJc3RydWN0IGh0eXBlICpoID0gc2V0LT5kYXRhOwo+IAlz
dHJ1Y3QgbGlzdF9oZWFkICpsLCAqbHQ7Cj4gCj4tCWlmIChTRVRfV0lUSF9USU1FT1VUKHNldCkp
Cj4tCQljYW5jZWxfZGVsYXllZF93b3JrX3N5bmMoJmgtPmdjLmR3b3JrKTsKPi0KPiAJbXR5cGVf
YWhhc2hfZGVzdHJveShzZXQsIGlwc2V0X2RlcmVmZXJlbmNlX25mbmwoaC0+dGFibGUpLCB0cnVl
KTsKPiAJbGlzdF9mb3JfZWFjaF9zYWZlKGwsIGx0LCAmaC0+YWQpIHsKPiAJCWxpc3RfZGVsKGwp
Owo+QEAgLTU5OCw2ICs1OTcsMTUgQEAgbXR5cGVfZ2NfaW5pdChzdHJ1Y3QgaHRhYmxlX2djICpn
YykKPiAJcXVldWVfZGVsYXllZF93b3JrKHN5c3RlbV9wb3dlcl9lZmZpY2llbnRfd3EsICZnYy0+
ZHdvcmssIEhaKTsKPiB9Cj4gCj4rc3RhdGljIHZvaWQKPittdHlwZV9jYW5jZWxfZ2Moc3RydWN0
IGlwX3NldCAqc2V0KQo+K3sKPisJc3RydWN0IGh0eXBlICpoID0gc2V0LT5kYXRhOwo+Kwo+Kwlp
ZiAoU0VUX1dJVEhfVElNRU9VVChzZXQpKQo+KwkJY2FuY2VsX2RlbGF5ZWRfd29ya19zeW5jKCZo
LT5nYy5kd29yayk7Cj4rfQo+Kwo+IHN0YXRpYyBpbnQKPiBtdHlwZV9hZGQoc3RydWN0IGlwX3Nl
dCAqc2V0LCB2b2lkICp2YWx1ZSwgY29uc3Qgc3RydWN0IGlwX3NldF9leHQgKmV4dCwKPiAJICBz
dHJ1Y3QgaXBfc2V0X2V4dCAqbWV4dCwgdTMyIGZsYWdzKTsKPkBAIC0xNDQwLDYgKzE0NDgsNyBA
QCBzdGF0aWMgY29uc3Qgc3RydWN0IGlwX3NldF90eXBlX3ZhcmlhbnQgbXR5cGVfdmFyaWFudCA9
IHsKPiAJLnVyZWYJPSBtdHlwZV91cmVmLAo+IAkucmVzaXplCT0gbXR5cGVfcmVzaXplLAo+IAku
c2FtZV9zZXQgPSBtdHlwZV9zYW1lX3NldCwKPisJLmNhbmNlbF9nYyA9IG10eXBlX2NhbmNlbF9n
YywKPiAJLnJlZ2lvbl9sb2NrID0gdHJ1ZSwKPiB9Owo+IAo+ZGlmZiAtLWdpdCBhL25ldC9uZXRm
aWx0ZXIvaXBzZXQvaXBfc2V0X2xpc3Rfc2V0LmMgYi9uZXQvbmV0ZmlsdGVyL2lwc2V0L2lwX3Nl
dF9saXN0X3NldC5jCj5pbmRleCBlMTYyNjM2NTI1Y2YuLjZjM2YyOGJjNTliMyAxMDA2NDQKPi0t
LSBhL25ldC9uZXRmaWx0ZXIvaXBzZXQvaXBfc2V0X2xpc3Rfc2V0LmMKPisrKyBiL25ldC9uZXRm
aWx0ZXIvaXBzZXQvaXBfc2V0X2xpc3Rfc2V0LmMKPkBAIC00MjYsOSArNDI2LDYgQEAgbGlzdF9z
ZXRfZGVzdHJveShzdHJ1Y3QgaXBfc2V0ICpzZXQpCj4gCXN0cnVjdCBsaXN0X3NldCAqbWFwID0g
c2V0LT5kYXRhOwo+IAlzdHJ1Y3Qgc2V0X2VsZW0gKmUsICpuOwo+IAo+LQlpZiAoU0VUX1dJVEhf
VElNRU9VVChzZXQpKQo+LQkJdGltZXJfc2h1dGRvd25fc3luYygmbWFwLT5nYyk7Cj4tCj4gCWxp
c3RfZm9yX2VhY2hfZW50cnlfc2FmZShlLCBuLCAmbWFwLT5tZW1iZXJzLCBsaXN0KSB7Cj4gCQls
aXN0X2RlbCgmZS0+bGlzdCk7Cj4gCQlpcF9zZXRfcHV0X2J5aW5kZXgobWFwLT5uZXQsIGUtPmlk
KTsKPkBAIC01NDUsNiArNTQyLDE1IEBAIGxpc3Rfc2V0X3NhbWVfc2V0KGNvbnN0IHN0cnVjdCBp
cF9zZXQgKmEsIGNvbnN0IHN0cnVjdCBpcF9zZXQgKmIpCj4gCSAgICAgICBhLT5leHRlbnNpb25z
ID09IGItPmV4dGVuc2lvbnM7Cj4gfQo+IAo+K3N0YXRpYyB2b2lkCj4rbGlzdF9zZXRfY2FuY2Vs
X2djKHN0cnVjdCBpcF9zZXQgKnNldCkKPit7Cj4rCXN0cnVjdCBsaXN0X3NldCAqbWFwID0gc2V0
LT5kYXRhOwo+Kwo+KwlpZiAoU0VUX1dJVEhfVElNRU9VVChzZXQpKQo+KwkJdGltZXJfc2h1dGRv
d25fc3luYygmbWFwLT5nYyk7Cj4rfQo+Kwo+IHN0YXRpYyBjb25zdCBzdHJ1Y3QgaXBfc2V0X3R5
cGVfdmFyaWFudCBzZXRfdmFyaWFudCA9IHsKPiAJLmthZHQJPSBsaXN0X3NldF9rYWR0LAo+IAku
dWFkdAk9IGxpc3Rfc2V0X3VhZHQsCj5AQCAtNTU4LDYgKzU2NCw3IEBAIHN0YXRpYyBjb25zdCBz
dHJ1Y3QgaXBfc2V0X3R5cGVfdmFyaWFudCBzZXRfdmFyaWFudCA9IHsKPiAJLmhlYWQJPSBsaXN0
X3NldF9oZWFkLAo+IAkubGlzdAk9IGxpc3Rfc2V0X2xpc3QsCj4gCS5zYW1lX3NldCA9IGxpc3Rf
c2V0X3NhbWVfc2V0LAo+KwkuY2FuY2VsX2djID0gbGlzdF9zZXRfY2FuY2VsX2djLAo+IH07Cj4g
Cj4gc3RhdGljIHZvaWQKPi0tIAo+Mi4zOS4yCj4KPkJlc3QgcmVnYXJkcywKPkpvenNlZgo+LS0g
Cj5FLW1haWwgIDoga2FkbGVjQGJsYWNraG9sZS5rZmtpLmh1LCBrYWRsZWNzaWsuam96c2VmQHdp
Z25lci5odQo+UEdQIGtleSA6IGh0dHBzOi8vd2lnbmVyLmh1L35rYWRsZWMvcGdwX3B1YmxpY19r
ZXkudHh0Cj5BZGRyZXNzIDogV2lnbmVyIFJlc2VhcmNoIENlbnRyZSBmb3IgUGh5c2ljcwo+ICAg
ICAgICAgIEgtMTUyNSBCdWRhcGVzdCAxMTQsIFBPQi4gNDksIEh1bmdhcnkK

